"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[3455],{67249:function(V,x,t){t.r(x),t.d(x,{default:function(){return me}});var e=t(32735),n=t(43383),v=t(83983),R=t(47765),B=t(68625),Z=t(4038),I=t(19406),D=t(27649),u=t(82055),C=t(41415),g=t(99223),$=t(17e3),S=t(56755),X=t(73269),G=t(33827),H=t(94547),T=t(19786),W=t(49372),J=t(3685),Y=t(35658),k=t(33795),w=t.n(k),b=t(67879),q=t(53038),_=t(67927),ee=()=>"todo empty role",te=t(60216),A=t.n(te),ne=t(87933),le=t(72850),ae=t(50563);const F=({id:s,name:o,description:l,usersCount:p,icons:r,rowIndex:m,canUpdate:f})=>{const{formatMessage:M}=(0,b.Z)(),[,i]=r,y=M({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:p});return e.createElement(H.Tr,{"aria-rowindex":m,key:s,...f?(0,n.X7)({fn:i.onClick}):{}},e.createElement(T.Td,{maxWidth:(0,n.Q1)(130)},e.createElement(W.Z,{ellipsis:!0,textColor:"neutral800"},o)),e.createElement(T.Td,{maxWidth:(0,n.Q1)(250)},e.createElement(W.Z,{ellipsis:!0,textColor:"neutral800"},l)),e.createElement(T.Td,null,e.createElement(W.Z,{textColor:"neutral800"},y)),e.createElement(T.Td,null,e.createElement(ne.k,{justifyContent:"flex-end",...n.UW},r.map((d,L)=>d?e.createElement(le.x,{key:d.label,paddingLeft:L===0?0:1},e.createElement(ae.h,{onClick:d.onClick,label:d.label,noBorder:!0,icon:d.icon})):null))))};F.propTypes={id:A().number.isRequired,name:A().string.isRequired,description:A().string.isRequired,usersCount:A().number.isRequired,icons:A().array.isRequired,rowIndex:A().number.isRequired,canUpdate:A().bool},F.defaultProps={canUpdate:!1};var se=F,oe=t(97889);const re={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1};var ie=(s,o)=>(0,oe.ZP)(s,l=>{switch(o.type){case"ON_REMOVE_ROLES":{l.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{l.shouldRefetchData=!0,l.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{l.shouldRefetchData=!1,l.roleToDelete=null,l.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{l.roleToDelete=o.id;break}default:return l}});const de=()=>{(0,n.go)();const{locale:s}=(0,b.Z)(),{isLoading:o,allowedActions:{canCreate:l,canDelete:p,canRead:r,canUpdate:m}}=(0,n.ss)(v.Z.settings.roles),{getData:f,roles:M,isLoading:i}=(0,_.bF)(!1),[{query:y}]=(0,n.Kx)(),d=y?._q||"",{includes:L}=(0,n.L0)(s,{sensitivity:"base"}),P=(0,n.Xe)(s,{sensitivity:"base"}),U=(M||[]).filter(h=>L(h.name,d)||L(h.description,d)).sort((h,O)=>P.compare(h.name,O.name)||P.compare(h.description,O.description));return(0,e.useEffect)(()=>{!o&&r&&f()},[o,r,f]),{isLoadingForPermissions:o,canCreate:l,canDelete:p,canRead:r,canUpdate:m,isLoading:i,getData:f,sortedRoles:U,roles:M}},ce=({getData:s,canCreate:o,canDelete:l,canUpdate:p})=>{const{formatMessage:r}=(0,b.Z)(),m=(0,n.lm)(),[f,M]=(0,e.useState)(!1),{push:i}=(0,q.k6)(),[{selectedRoles:y,showModalConfirmButtonLoading:d,roleToDelete:L},P]=(0,e.useReducer)(ie,re),{post:U}=(0,n.tg)(),h=async()=>{try{P({type:"ON_REMOVE_ROLES"}),await U("/admin/roles/batch-delete",{ids:[L]}),await s(),P({type:"RESET_DATA_TO_DELETE"})}catch(a){const c=w()(a,["response","payload","data","ids"],null);if(c&&Array.isArray(c)){const ge=c.join(`
`);m({type:"warning",message:ge})}else m({type:"warning",message:{id:"notification.error"}})}E()},O=(0,e.useCallback)(a=>{i(`/settings/roles/duplicate/${a}`)},[i]),N=()=>i("/settings/roles/new"),K=(0,e.useCallback)(a=>{P({type:"SET_ROLE_TO_DELETE",id:a}),E()},[]),E=()=>M(a=>!a),j=(0,e.useCallback)(a=>{i(`/settings/roles/${a}`)},[i]),Q=(0,e.useCallback)((a,c)=>{a.preventDefault(),a.stopPropagation(),c.usersCount?m({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):K(c.id)},[m,K]),z=(0,e.useCallback)((a,c)=>{a.preventDefault(),a.stopPropagation(),O(c.id)},[O]),Ee=(0,e.useCallback)(a=>[...o?[{onClick:c=>z(c,a),label:r({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(R.Z,null)}]:[],...p?[{onClick:()=>j(a.id),label:r({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(B.Z,null)}]:[],...l?[{onClick:c=>Q(c,a),label:r({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Z.Z,null)}]:[]],[r,Q,z,j,o,p,l]);return{handleNewRoleClick:N,getIcons:Ee,selectedRoles:y,isWarningDeleteAllOpened:f,showModalConfirmButtonLoading:d,handleToggleModal:E,handleDeleteData:h}};var ue=()=>{const{formatMessage:s}=(0,b.Z)(),{isLoadingForPermissions:o,canCreate:l,canRead:p,canDelete:r,canUpdate:m,isLoading:f,getData:M,sortedRoles:i}=de(),{handleNewRoleClick:y,getIcons:d,isWarningDeleteAllOpened:L,showModalConfirmButtonLoading:P,handleToggleModal:U,handleDeleteData:h}=ce({getData:M,canCreate:l,canDelete:r,canUpdate:m}),O=i.length+1,N=6;if(o)return e.createElement(D.o,null,e.createElement(n.dO,null));const K=s({id:"global.roles",defaultMessage:"roles"});return e.createElement(D.o,null,e.createElement(n.SL,{name:"Roles"}),e.createElement(u.T,{primaryAction:l?e.createElement(C.z,{onClick:y,startIcon:e.createElement(I.Z,null),size:"S"},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:K,subtitle:s({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),p&&e.createElement(g.Z,{startActions:e.createElement(n.m,{label:s({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:K})})}),p&&e.createElement($.D,null,e.createElement(S.i,{colCount:N,rowCount:O,footer:l?e.createElement(X.c,{onClick:y,icon:e.createElement(I.Z,null)},s({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(G.h,null,e.createElement(H.Tr,{"aria-rowindex":1},e.createElement(T.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.name",defaultMessage:"Name"}))),e.createElement(T.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.description",defaultMessage:"Description"}))),e.createElement(T.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},s({id:"global.users",defaultMessage:"Users"}))),e.createElement(T.Th,null,e.createElement(J.T,null,s({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Y.p,null,i?.map((E,j)=>e.createElement(se,{key:E.id,id:E.id,name:E.name,description:E.description,usersCount:E.usersCount,icons:d(E),rowIndex:j+2,canUpdate:m})))),!O&&!f&&e.createElement(ee,null)),e.createElement(n.QH,{isOpen:L,onConfirm:h,isConfirmButtonLoading:P,onToggleDialog:U}))},me=()=>e.createElement(n.O4,{permissions:v.Z.settings.roles.main},e.createElement(ue,null))},99223:function(V,x,t){t.d(x,{Z:function(){return D}});var e=t(32735),n=t(60216),v=t(8471),R=t(72850),B=t(87933);const Z=(0,v.ZP)(B.k)`
  & > * + * {
    margin-left: ${({theme:u})=>u.spaces[2]};
  }

  margin-left: ${({pullRight:u})=>u?"auto":void 0};
`,I=(0,v.ZP)(Z)`
  flex-shrink: 0;
`,D=({startActions:u,endActions:C})=>u||C?e.createElement(R.x,{paddingLeft:10,paddingRight:10},e.createElement(R.x,{paddingBottom:4},e.createElement(B.k,{justifyContent:"space-between",alignItems:"flex-start"},u&&e.createElement(Z,{wrap:"wrap"},u),C&&e.createElement(I,{pullRight:!0},C)))):null;D.defaultProps={endActions:void 0,startActions:void 0},D.propTypes={endActions:n.node,startActions:n.node}},73269:function(V,x,t){t.d(x,{c:function(){return C}});var e=t(32735),n=t(60216),v=t(8471),R=t(72850),B=t(9026),Z=t(87933),I=t(49372);const D=(0,v.ZP)(R.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:g})=>g.colors.primary600};
  }
`,u=(0,v.ZP)(R.x)`
  border-radius: 0 0 ${({theme:g})=>g.borderRadius} ${({theme:g})=>g.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,C=({children:g,icon:$,...S})=>e.createElement("div",null,e.createElement(B.i,null),e.createElement(u,{as:"button",background:"primary100",padding:5,...S},e.createElement(Z.k,null,e.createElement(D,{"aria-hidden":!0,background:"primary200"},$),e.createElement(R.x,{paddingLeft:3},e.createElement(I.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600"},g)))));C.propTypes={children:n.string.isRequired,icon:n.node.isRequired}}}]);
